var updateid="",selectedstatus="",taskid="",i=0;function makeid(t){for(var a="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=e.length,d=0;d<t;d++)a+=e.charAt(Math.floor(Math.random()*s));return a}$(document).ready(function(){"use strict";$("#NewtaskForm").validate({rules:{"member[]":{required:!0}},errorPlacement:function(t,a){a.is(":checkbox")?t.insertAfter("#taskassignee"):t.insertAfter(a)}}),$(".addtask-btn").click(function(){var t=$(this).attr("data-id");$("#updatetaskdetail").css("display","none"),$("#addtask").css("display","block"),$(".update-task-title").css("display","none"),$(".add-task-title").css("display","block"),$("#taskname").val(""),$("#taskdesc").val(""),$("#TaskStatus").val(""),$("#taskbudget").val(""),$("#taskassignee input").prop("checked",!1),taskid=t}),$("select#TaskStatus").change(function(){selectedstatus=$(this).children("option:selected").val()}),$("#addtask").click(function(){$("#updatetaskdetail").css("display","none"),$("#addtask").css("display","block"),$(".update-task-title").css("display","none"),$(".add-task-title").css("display","block");var t,a=makeid(5),e=$("#taskname").val(),s=new Date,s=s.getDate()+" "+s.toLocaleString("default",{month:"short"})+", "+s.getFullYear(),d=$("#taskdesc").val(),l="",d=(0<d.length&&(l="<ul class='ps-3 mb-4 text-muted' id='task-desc'><li class='py-1'>"+d+"</li></ul>"),$("#taskbudget").val()),n=new Array,r=new Array,c="";for($("#taskassignee input[type=checkbox]:checked").each(function(){r.push($(this).attr("id")),n.push($(this).nextAll("img").attr("src"))}),i=0;i<n.length;i++)c=c+'<div class="avatar-group-item"><a href="#" class="d-inline-block" value="'+r[i]+'"><img src="'+n[i]+'" class="rounded-circle avatar-xs" alt=""></a></div>';"Waiting"==selectedstatus?t="bg-secondary-subtle text-secondary ":"Approved"==selectedstatus?t="bg-primary-subtle text-primary ":"Complete"==selectedstatus?t="bg-success-subtle text-success ":"Pending"==selectedstatus&&(t="bg-warning-subtle text-warning "),0==e.length||0==d.length||0==selectedstatus.length||0==n.length?($("#NewtaskForm").validate().element("#taskname"),$("#NewtaskForm").validate().element("#taskassignee input:checkbox"),$("#NewtaskForm").validate().element("#TaskStatus"),$("#NewtaskForm").validate().element("#taskbudget")):($(taskid).append("<div class='card task-box' id='"+a+"'><div class='card-body'><div class='dropdown float-end'><a href='#' class='dropdown-toggle arrow-none' data-bs-toggle='dropdown' aria-expanded='false'><i class='mdi mdi-dots-vertical m-0 text-muted h5'></i></a><div class='dropdown-menu dropdown-menu-end'><a class='dropdown-item edittask-details' href='#' data-bs-toggle='modal' data-bs-target='.bs-example-modal-lg' data-id='#"+a+"'>Edit</a><a class='dropdown-item deletetask' href='#' data-id='#"+a+"'>Delete</a></div></div><div class='float-end ms-2'><span class='badge rounded-pill font-size-12 "+t+"' id='task-status'>"+selectedstatus+"</span></div><div><h5 class='font-size-15'><a href='javascript: void(0);' class='text-dark' id='task-name'>"+e+"</a></h5><p class='text-muted mb-4' id='task-date'>"+s+"</p></div>"+l+"<div class='avatar-group float-start task-assigne'>"+c+"</div><div class='text-end'><h5 class='font-size-15 mb-1' id='task-budget'>$ "+d+"</h5><p class='mb-0 text-muted'>Budget</p></div></div></div>"),$("#modalForm").modal("toggle"))}),$("#modalForm").on("hidden.bs.modal",function(t){var a=$("#NewtaskForm").validate();$("#taskname").removeClass("error").next("label.error").remove(),$("#TaskStatus").removeClass("error").next("label.error").remove(),$("#taskbudget").removeClass("error").next("label.error").remove(),a.resetForm()}),$("#updatetaskdetail").click(function(){"Waiting"==selectedstatus?t="bg-secondary-subtle text-secondary ":"Approved"==selectedstatus?t="bg-primary-subtle text-primary ":"Complete"==selectedstatus?t="bg-success-subtle text-success ":"Pending"==selectedstatus&&(t="bg-warning-subtle text-warning ");var t,a=$("#taskname").val(),e=new Date,e=e.getDate()+" "+e.toLocaleString("default",{month:"short"})+", "+e.getFullYear(),s=$("#taskdesc").val(),d=$("#taskbudget").val(),l=new Array,n=new Array,r="";for($("#taskassignee input[type=checkbox]:checked").each(function(){n.push($(this).attr("id")),l.push($(this).nextAll("img").attr("src"))}),i=0;i<l.length;i++)r=r+'<div class="avatar-group-item"><a href="#" class="d-inline-block" value="'+n[i]+'"><img src="'+l[i]+'" class="rounded-circle avatar-xs" alt=""></a></div>';var c="";0<s.length&&(c="<ul class='ps-3 mb-4 text-muted' id='task-desc'><li class='py-1'>"+s+"</li></ul>"),0==a.length||0==d.length||0==selectedstatus.length||0==l.length?($("#NewtaskForm").validate().element("#taskname"),$("#NewtaskForm").validate().element("#taskassignee input:checkbox"),$("#NewtaskForm").validate().element("#TaskStatus"),$("#NewtaskForm").validate().element("#taskbudget")):($(updateid).html("<div class='card-body'><div class='dropdown float-end'><a href='#' class='dropdown-toggle arrow-none' data-bs-toggle='dropdown' aria-expanded='false'><i class='mdi mdi-dots-vertical m-0 text-muted h5'></i></a><div class='dropdown-menu dropdown-menu-end'><a class='dropdown-item edittask-details' href='#' data-bs-toggle='modal' data-bs-target='.bs-example-modal-lg' data-id='"+updateid+"'>Edit</a><a class='dropdown-item deletetask' href='#' data-id='"+updateid+"'>Delete</a></div></div> <div class='float-end ms-2'><span class='badge rounded-pill font-size-12 "+t+"' id='task-status'>"+selectedstatus+"</span></div><div><h5 class='font-size-15'><a href='javascript: void(0);' class='text-dark' id='task-name'>"+a+"</a></h5><p class='text-muted'>"+e+"</p></div>"+c+"<div class='avatar-group float-start task-assigne'>"+r+"</div><div class='text-end'><h5 class='font-size-15 mb-1' id='task-budget'>$ "+d+"</h5><p class='mb-0 text-muted'>Budget</p></div></div>"),$("#modalForm").modal("hide"))}),$(".main-content").on("click",".edittask-details",function(t){var a=$(this).attr("data-id");updateid=a;$("#NewtaskForm").validate().resetForm(),$("#updatetaskdetail").css("display","block"),$("#addtask").css("display","none"),$(".update-task-title").css("display","block"),$(".add-task-title").css("display","none");var e=$(a).find("#task-name").text(),s=$(a).find("#task-desc").text(),d=parseInt($(a).find("#task-budget").text().replace(/[^0-9.]/g,"")),l=$(a).find("#task-status").text();$("#taskassignee input").prop("checked",!1),$(a).find(".task-assigne a").each(function(){var t=$(this).attr("value");$("#"+t).prop("checked",!0)}),$("#taskname").val(e),$("#taskdesc").val(s),$("#taskbudget").val(d),$("#TaskStatus").val(l),selectedstatus=l}),$(".main-content").on("click",".deletetask",function(t){var a=$(this).attr("data-id");console.log("Task Deleted Successfully"),$(a).remove()})});